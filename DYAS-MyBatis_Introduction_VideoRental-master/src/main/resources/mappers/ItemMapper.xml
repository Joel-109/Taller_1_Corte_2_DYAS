<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="edu.unisabana.dyas.sampleprj.dao.mybatis.mappers.ItemMapper">
  <insert parameterType='map' id='insertarItem'>
      INSERT INTO VI_ITEMS (id, nombre, descripcion, fechalanzamiento, tarifaxdia, formatorenta, genero, TIPOITEM_id) VALUES
      (#{item.id}, #{item.nombre}, #{item.descripcion}, #{item.fechaLanzamiento}, #{item.tarifaxDia}, #{item.formatoRenta}, #{item.genero}, #{item.tipo.id})
  </insert>

  <select id="consultarItems" parameterType='map' resultMap="ItemResult">
    SELECT 
        i.id,
        i.nombre,
        i.descripcion,
         strftime('%Y-%m-%d %H:%M:%S', i.fechalanzamiento) AS fechalanzamiento,
        i.tarifaxdia,
        i.formatorenta,
        i.genero,
        ti.id AS ti_id,
        ti.descripcion AS ti_descripcion
    FROM VI_ITEMS i
    JOIN VI_TIPOITEM ti ON i.TIPOITEM_id = ti.id
  </select>

  <select id="consultarItem" parameterType='map' resultMap="ItemResult">
    SELECT 
        i.id,
        i.nombre,
        i.descripcion,
         strftime('%Y-%m-%d %H:%M:%S', i.fechalanzamiento) AS fechalanzamiento,
        i.tarifaxdia,
        i.formatorenta,
        i.genero,
        ti.id AS ti_id,
        ti.descripcion AS ti_descripcion
    FROM VI_ITEMS i
    JOIN VI_TIPOITEM ti ON i.TIPOITEM_id = ti.id
    WHERE i.id = #{idcli}
  </select>

  <resultMap type='Item' id='ItemResult'>
      <id property='id' column='id'/>
      <result property='nombre' column='nombre'/>
      <result property='descripcion' column='descripcion'/>
      <result property='fechaLanzamiento' column='fechalanzamiento' />
      <result property='tarifaxDia' column='tarifaxdia'/>
      <result property='formatoRenta' column='formatorenta'/>
      <result property='genero' column='genero'/>
      <association property="tipo" resultMap='edu.unisabana.dyas.sampleprj.dao.mybatis.mappers.TipoItemMapper.TipoItemResult' columnPrefix='ti_'/>  
  </resultMap>

  <!-- 
  this.tipo = tipo;
        this.id = id;
        this.nombre = nombre;
        this.descripcion = descripcion;
        this.fechaLanzamiento = fechaLanzamiento;
        this.tarifaxDia = tarifaxDia;
        this.formatoRenta = formatoRenta;
        this.genero = genero;
  -->

</mapper>